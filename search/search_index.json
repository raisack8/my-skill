{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u30db\u30fc\u30e0","text":"<p>\u3053\u3053\u3067\u306f\u4eca\u307e\u3067\u57f9\u3063\u3066\u304d\u305f\u77e5\u8b58\u3092\u3054\u7d39\u4ecb\u3044\u305f\u3057\u307e\u3059\u3002</p>"},{"location":"aws-first-01/","title":"AWS","text":""},{"location":"bat-01/","title":"Bat","text":""},{"location":"gcp-first-01/","title":"GCP","text":""},{"location":"gcp-first-01/#sheet-api","title":"Sheet API","text":"<p>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210 \u2193 Google Sheet API\u3092\u6709\u52b9\u306b\u3059\u308b \u2193 \u300cAPI\u3068\u30b5\u30fc\u30d3\u30b9\u3092\u6709\u52b9\u306b\u3059\u308b\u300d\u3092\u30af\u30ea\u30c3\u30af \u2193 Google Drive API\u3092\u6709\u52b9\u306b\u3059\u308b  </p> <p>\u8a8d\u8a3c\u60c5\u5831 \u2193 \u8a8d\u8a3c\u60c5\u5831\u3092\u4f5c\u6210 \u2193 \u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210 \u2193 \u30ed\u30fc\u30eb:\u300c\u57fa\u672c\u300d&gt;\u300c\u7de8\u96c6\u8005\u300d \u2193 \u5148\u307b\u3069\u4f5c\u3063\u305f\u30e6\u30fc\u30b6\u30fc\u306e\u300c\u30ad\u30fc\u300d&gt;\u300c\u65b0\u3057\u3044\u9375\u3092\u4f5c\u6210\u300d&gt; Json\u3067DL</p> <p>Json\u3092Python\u306e\u30ef\u30fc\u30af\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u5165\u308c\u3066\u304a\u304f</p> <pre><code>pip install gspread\npip install gspread-formatting\n</code></pre> <p>\u30c9\u30e9\u30a4\u30d6\u306b\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u308a\u3001Drive\u306eURL\u306e\u5f8c\u308d\u306e\u90e8\u5206\u3092\u63a7\u3048\u3066\u304a\u304f json\u306eclient_email\u3092\u30b3\u30d4\u30fc \u30c9\u30e9\u30a4\u30d6\u306e\u30d5\u30a9\u30eb\u30c0\u3092\u5171\u6709&gt;\u5148\u307b\u3069\u306e\u30a2\u30c9\u30ec\u30b9\u3092\u8ffd\u52a0\u3001\u30ed\u30fc\u30eb\u306f\u7de8\u96c6\u8005\u3067\u5171\u6709  </p> <p>\u30b7\u30fc\u30c8\u306e\u4f5c\u6210 <pre><code>import gspread\n\n# GCP\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\ngc = gspread.service_account(\n    filename=\"spread-sheet.json\"\n)\n# \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\nsh = gc.create(\n    \"sheat_name\", # \u30d5\u30a1\u30a4\u30eb\u540d\n    folder_id = \"Drive\u306e\u30d5\u30a9\u30eb\u30c0ID\"\n)\n# \u4e00\u3064\u76ee\u306e\u30b7\u30fc\u30c8\u3092\u53d6\u5f97\u3000\nws = sh.get_worksheet(0)\nws.update_acell(\"A1\", 2014)\n\n# \u2192 \u300csheet_name\u300d\u3068\u3044\u3046\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304c\u3067\u304d\u3001A1\u306b\u300c2014\u300d\u304c\u66f8\u304b\u308c\u3066\u3044\u308b\n</code></pre></p> <p>\u30b7\u30fc\u30c8\u306e\u8aad\u307f\u8fbc\u307f <pre><code>import gspread\n\n# GCP\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\ngc = gspread.service_account(\n    filename=\"spread-sheet.json\"\n)\n# \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\nsh = gc.open(\n    \"sheat_name\", # \u30d5\u30a1\u30a4\u30eb\u540d\n    folder_id = \"Drive\u306e\u30d5\u30a9\u30eb\u30c0ID\"\n)\n# \u4e00\u3064\u76ee\u306e\u30b7\u30fc\u30c8\u3092\u53d6\u5f97\u3000\nws = sh.get_worksheet(\"Sheet_name\") # \u30b7\u30fc\u30c8\u540d\u3092\u6307\u5b9a\nnumber = [[n, n + 100] for n in raige(1, 101)]\nws.update(range_name=\"A1:B100\", values=numbers)\n# \u2192 \u65e2\u5b58\u306e\u30b7\u30fc\u30c8\u306b\u5024\u3092\u66f8\u304d\u8fbc\u3080\n</code></pre> pandas\u3092\u4f7f\u3046\u3068\u3088\u308aDataFrame\u3092\u305d\u306e\u307e\u307e\u4f7f\u3048\u308b <pre><code>ws = sh.get_worksheet(\"Sheet_name\")\ndf = pd.DataFrame({\n    \"\u540d\u524d\": [\"\u658e\u85e4\", \"\u5c71\u7530\", \"\u7530\u4e2d\"],\n    \"\u5e74\u9f62\": [35, 20, 56]\n})\nws.update(\n    [df.columns.values.tolist()] # \u30ab\u30e9\u30e0\u540d\u306e\u591a\u91cd\u30ea\u30b9\u30c8\n    + df.values.tolist() # \u5404\u884c\u306e\u30c7\u30fc\u30bf\u306e\u591a\u91cd\u30ea\u30b9\u30c8\n)\n</code></pre></p> <pre><code># \u30b7\u30fc\u30c8\u306e\u5185\u5bb9\u3092\u5168\u3066\u524a\u9664\nws.clear()\n</code></pre> <p>\u30b7\u30fc\u30c8\u306e\u8aad\u307f\u8fbc\u307f <pre><code>ws = sh.get_worksheet(\"Sheet_name\") # \u30b7\u30fc\u30c8\u540d\u3092\u6307\u5b9a\nval = ws.acell(\"A1\").value # \u30bb\u30eb\u3092\u6307\u5b9a\u3057\u3066\u5024\u3092\u53d6\u5f97\n\nrow_2 = ws.row_values(2) # 2\u884c\u76ee\u306e\u30c7\u30fc\u30bf\u3092\u5168\u3066\u53d6\u5f97\ncol_2 = ws.col_values(2) # 2\u5217\u76ee\u306e\u30c7\u30fc\u30bf\u3092\u5168\u3066\u53d6\u5f97\n\nall_values = ws.get_all_values() # \u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n\ndf = pd.DataFrame(ws.get_all_record()) # \u30b7\u30fc\u30c8\u306e\u30c7\u30fc\u30bf\u3092DataFrame\u3067\u53d6\u5f97\n</code></pre></p> <p>\u30b7\u30fc\u30c8\u306e\u8ffd\u52a0 <pre><code>sh = gc.open(\n    \"sheat_name\", # \u30d5\u30a1\u30a4\u30eb\u540d\n    folder_id = \"Drive\u306e\u30d5\u30a9\u30eb\u30c0ID\"\n)\nws = sh.add_worksheet(\n    title=\"\u30b7\u30fc\u30c8\u306e\u30bf\u30a4\u30c8\u30eb\",\n    rows=100,\n    cols=20\n)\n</code></pre></p> <p>\u30b7\u30fc\u30c8\u306e\u524a\u9664 <pre><code>sh = gc.open(\n    \"sheat_name\", # \u30d5\u30a1\u30a4\u30eb\u540d\n    folder_id = \"Drive\u306e\u30d5\u30a9\u30eb\u30c0ID\"\n)\nws = sh.get_worksheet(\"\u30b7\u30fc\u30c8\u306e\u30bf\u30a4\u30c8\u30eb\")\nsh.del_worksheet(ws)\n</code></pre></p> <p>\u66f8\u5f0f\u306e\u5909\u66f4 <pre><code>ws = sh.get_worksheet(\"\u30b7\u30fc\u30c8\u306e\u30bf\u30a4\u30c8\u30eb\")\n# A1:B1\u306e\u6587\u5b57\u304cbold\nws.format(\"A1:B1\",{\n    \"textFormat\": {\"bold\": True}\n    }\n)\n# A1:B1\u306e\u6587\u5b57\u304cbold\u3067\u3001\u30d5\u30a9\u30f3\u30c8\u30b5\u30a4\u30ba\u304c15\u3067\u3001\u4e2d\u592e\u5bc4\u305b\nws.format(\"A1:B1\",{\n    \"textFormat\": {\n        \"bold\": True,\n        \"fontSize\": 15\n        }\n    },\n    \"horizontalAlignment\": \"CENTER\" # \u5de6\u5bc4\u305b: LEFT, \u53f3\u5bc4\u305b: RIGHT\n)\n</code></pre></p> <p>\u7f6b\u7dda\u3092\u5f15\u304f <pre><code>import gspread\nfrom gspread_formatting import (\n    Border, Color, CellFormat, Borders, format_cell_range\n)\n\nws = sh.get_worksheet(\"\u30b7\u30fc\u30c8\u306e\u30bf\u30a4\u30c8\u30eb\")\n# \u7f6b\u7dda\u306e\u7a2e\u985e\u3092\u5b9a\u7fa9\u3059\u308b: \u5b9f\u7dda, \u8d64, \u592a\u30551\nb = Border(\"SOLID\", Color(1, 0, 0), width=1)\n# \u3069\u306e\u3088\u3046\u306a\u7f6b\u7dda\u3092\u5f15\u304f\u304b: \u4e0a\u4e0b\u5de6\u53f3\nfmt = CellFormat(\n    borders=Borders(\n        top=b,\n        botton=b,\n        left=b,\n        right=b,\n    )\n)\n# \u3069\u3053\u306b\u7f6b\u7dda\u3092\u5f15\u304f\u304b\nformat_cell_rangfe(ws, \"A1:B1\", fmt)\n</code></pre></p>"},{"location":"hack-vscode-01/","title":"VSCODE","text":""},{"location":"psql-01/","title":"PostgreSQL","text":""},{"location":"JS/nextjs/ne-about/","title":"Next.js\u306b\u3064\u3044\u3066","text":"<p>\u306e\u524d\u306b\u3001<code>onpm</code>\u306e\u4f7f\u7528\u304c\u63a8\u5968\u3055\u308c\u3066\u3044\u308b\u3002 \u7406\u7531: npm\u3088\u308a\u9ad8\u901f\u304b\u3064\u52b9\u7387\u7684\u3067\u3042\u308b\u304b\u3089 <pre><code>npm install -g pnpm\n</code></pre></p>"},{"location":"JS/nextjs/ne-about/#_1","title":"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d5\u30a9\u30eb\u30c0\u306e\u69cb\u9020","text":"<p><code>/app</code>: \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u3059\u3079\u3066\u306e\u30eb\u30fc\u30c8\u3001\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3001\u30ed\u30b8\u30c3\u30af\u304c\u542b\u307e\u308c\u3066\u304a\u308a\u3001\u4e3b\u306b\u3053\u3053\u3067\u4f5c\u696d\u3092\u884c\u3044\u307e\u3059\u3002</p> <p><code>/app/lib</code>: \u518d\u5229\u7528\u53ef\u80fd\u306a\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\u95a2\u6570\u3084\u30c7\u30fc\u30bf\u53d6\u5f97\u95a2\u6570\u306a\u3069\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u4f7f\u7528\u3055\u308c\u308b\u95a2\u6570\u304c\u542b\u307e\u308c\u307e\u3059\u3002</p> <p><code>/app/ui</code>: \u30ab\u30fc\u30c9\u3001\u30c6\u30fc\u30d6\u30eb\u3001\u30d5\u30a9\u30fc\u30e0\u306a\u3069\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u3059\u3079\u3066\u306e UI \u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002\u6642\u9593\u3092\u7bc0\u7d04\u3059\u308b\u305f\u3081\u306b\u3001\u3053\u308c\u3089\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306f\u4e8b\u524d\u306b\u30b9\u30bf\u30a4\u30eb\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u3002</p> <p><code>/public</code>: \u753b\u50cf\u306a\u3069\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u3059\u3079\u3066\u306e\u9759\u7684\u30a2\u30bb\u30c3\u30c8\u304c\u542b\u307e\u308c\u307e\u3059\u3002</p>"},{"location":"JS/nextjs/ne-about/#_2","title":"\u958b\u767a\u30b5\u30fc\u30d0\u30fc\u306e\u5b9f\u884c","text":"<p>\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb <pre><code>pnpm i\n</code></pre> dev\u30b5\u30fc\u30d0\u30fc\u306e\u8d77\u52d5 <pre><code>pnpm dev\n</code></pre></p>"},{"location":"JS/nextjs/ne-about/#css","title":"CSS\u306b\u3064\u3044\u3066","text":"<p>\u30eb\u30fc\u30c8\u30ec\u30a4\u30a2\u30a6\u30c8: global.css \u4ee5\u4e0b\u3067\u8aad\u307f\u8fbc\u3080\u3002\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\u6642\u306btailwind\u304cON\u306b\u306a\u3063\u305f\u3089tailwind\u7528\u306e\u8a18\u8f09\u3082\u66f8\u304b\u308c\u308b\u3002 <pre><code>import '@/app/ui/global.css';\n</code></pre></p> <p>\u66f8\u304d\u65b9 <pre><code>&lt;main className=\"flex min-h-screen flex-col p-6\"&gt;&lt;/main&gt;\n</code></pre></p>"},{"location":"JS/nextjs/ne-about/#clsx","title":"clsx\u30af\u30e9\u30b9\u3092\u4f7f\u7528\u3057\u3066\u898b\u305f\u76ee\u3092\u5236\u5fa1\u3059\u308b","text":"<p><pre><code>import clsx from 'clsx';\n\n\nexport default function Flg() {\n  const flg = true\n  return (\n    &lt;p className={clsx(\n            'text-blue-500',\n            {\n              'bg-yellow-300': !flg,\n              'bg-green-500': flg,\n            }\n          )}&gt;Hello&lt;/p&gt;\n    // ...\n)}\n</code></pre> </p>"},{"location":"JS/nextjs/ne-about/#css_1","title":"CSS\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3046\u5834\u5408","text":"<p>\u4f8b) /app/ui/home.module.css <pre><code>.shape {\n  height: 0;\n  width: 0;\n  border-bottom: 30px solid black;\n  border-left: 20px solid transparent;\n  border-right: 20px solid transparent;\n}\n</code></pre></p>"},{"location":"JS/nextjs/ne-about/#_3","title":"\u30d5\u30a9\u30f3\u30c8\u3068\u753b\u50cf\u306e\u6700\u9069\u5316","text":""},{"location":"JS/nextjs/ne-about/#_4","title":"\u30d5\u30a9\u30f3\u30c8\u306e\u8aad\u307f\u8fbc\u307f","text":"<p>\u30a4\u30e1\u30fc\u30b8\u3002\u81ea\u52d5\u3067\u30ec\u30a4\u30a2\u30a6\u30c8\u3084\u30d5\u30a9\u30f3\u30c8\u3092\u6700\u9069\u5316 </p> <p>/app/ui/fonts.ts <pre><code>import { Inter } from 'next/font/google';\n// \u30d5\u30a9\u30f3\u30c8\u306b\u3088\u3063\u3066\u8272\u3005\u306a\u30af\u30e9\u30b9\u306e\u7a2e\u985e\u304c\u3042\u308b\u306e\u3067\u3001\n// \u90fd\u5ea6\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b(\u4f8b: Instrument_Serif)\n// GoogleFont\u53c2\u7167\nexport const inter = Inter({ subsets: ['latin'] });\n</code></pre> /app/layout.tsx <pre><code>import '@/app/ui/global.css';\n\nimport { inter } from '@/app/ui/fonts';\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body className={`${inter.className} antialiased`}&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  );\n}\n</code></pre> <code>antialiased</code>\u306f\u30d5\u30a9\u30f3\u30c8\u3092\u6ed1\u3089\u304b\u306b\u3059\u308b\u30af\u30e9\u30b9\u3002 \u4f7f\u7528\u3059\u308b\u3068\u7d20\u6575\u306a\u30bf\u30c3\u30c1\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002  </p> <p>\u7279\u5b9a\u306e\u8981\u7d20\u306b\u3082\u30af\u30e9\u30b9\u3092\u5272\u308a\u5f53\u3066\u3066\u3042\u3052\u308c\u3070\u30d5\u30a9\u30f3\u30c8\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002</p> <p></p>"},{"location":"JS/nextjs/ne-about/#_5","title":"\u753b\u50cf\u306e\u8aad\u307f\u8fbc\u307f","text":"<p>img\u30bf\u30b0\u306f\u4f7f\u308f\u305a\u3001Image\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u4f7f\u3046\u3088\u3046\u306b\u3059\u308b\u3002 <pre><code>import Image from 'next/image';\n...\n&lt;Image\n    src=\"/hero-desktop.png\"\n    // public\u76f4\u4e0b\u306e\u753b\u50cf\u3092\u53c2\u7167\u3057\u3066\u3044\u308b\u3002\n    width={1000}\n    height={760}\n    className=\"hidden md:block\"\n    alt=\"Screenshots of the dashboard project showing desktop version\"\n    /&gt;\n</code></pre></p>"},{"location":"JS/nextjs/ne-about/#_6","title":"\u53c2\u8003\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<p>\u753b\u50cf\u6700\u9069\u5316\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 \u30d5\u30a9\u30f3\u30c8\u6700\u9069\u5316\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</p>"},{"location":"JS/nextjs/ne-db/","title":"DB\u306e\u8a2d\u5b9a","text":""},{"location":"JS/nextjs/ne-db/#_1","title":"\u30c7\u30fc\u30bf\u53d6\u5f97\u624b\u9806","text":"<p><code>/app/libs</code>\u306bDB\u64cd\u4f5c\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f5c\u308b\u3002 \u5404\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3067\u306fSQL\u5b9f\u884c\u95a2\u6570\u3092\u5b9f\u884c\u3057\u3001\u8fd4\u308a\u5024\u3092\u53d6\u5f97\u3059\u308b\u3002</p> <p><pre><code>import { sql } from '@vercel/postgres';\n</code></pre> \u3053\u308c\u3092\u8a18\u8f09\u3059\u308b\u3053\u3068\u3067\u3001\u74b0\u5883\u5909\u6570\u3092\u4f7f\u3063\u3066DB\u306b\u63a5\u7d9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002</p> <p>\u8fd4\u5374\u5024\u306f<code>sql</code>\u306e\u5f8c\u308d\u306b\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u3067\u3001\u578b\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002 <pre><code>const data = await sql&lt;InvoiceForm&gt;`~~~`\n</code></pre></p> <p>SELECT\u4f8b <pre><code>import { sql } from '@vercel/postgres';\n\nexport async function fetchInvoiceById(id: string) {\n  try {\n    const data = await sql&lt;InvoiceForm&gt;`\n      SELECT\n        invoices.id,\n        invoices.customer_id,\n        invoices.amount,\n        invoices.status\n      FROM invoices\n      WHERE invoices.id = ${id};\n    `;\n\n    const invoice = data.rows.map((invoice) =&gt; ({\n      ...invoice,\n      // Convert amount from cents to dollars\n      amount: invoice.amount / 100,\n    }));\n\n    return invoice[0];\n  } catch (error) {\n    console.error('Database Error:', error);\n    throw new Error('Failed to fetch invoice.');\n  }\n}\n</code></pre></p>"},{"location":"JS/nextjs/ne-db/#promise","title":"Promise","text":""},{"location":"JS/nextjs/ne-db/#_2","title":"\u30ea\u30af\u30a8\u30b9\u30c8\u30a6\u30a9\u30fc\u30bf\u30fc\u30d5\u30a9\u30fc\u30eb","text":"<p>\u524d\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u5b8c\u4e86\u306b\u4f9d\u5b58\u3059\u308b\u4e00\u9023\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u6307\u3057\u307e\u3059\u3002</p> <p>\u5404\u30ea\u30af\u30a8\u30b9\u30c8\u306f\u524d\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u30c7\u30fc\u30bf\u3092\u8fd4\u3057\u305f\u5f8c\u306b\u306e\u307f\u958b\u59cb\u3067\u304d\u307e\u3059</p>"},{"location":"JS/nextjs/ne-db/#_3","title":"\u4e26\u5217\u30c7\u30fc\u30bf\u53d6\u5f97","text":"<p>\u30a6\u30a9\u30fc\u30bf\u30fc\u30d5\u30a9\u30fc\u30eb\u3092\u56de\u907f\u3059\u308b\u4e00\u822c\u7684\u306a\u65b9\u6cd5\u306f\u3001 \u3059\u3079\u3066\u306e\u30c7\u30fc\u30bf\u8981\u6c42\u3092\u540c\u6642\u306b\u3001\u3064\u307e\u308a\u4e26\u884c\u3057\u3066\u958b\u59cb\u3059\u308b\u3053\u3068\u3067\u3059\u3002</p> <p><code>Promise.all()</code>, <code>Promise.allSettled()</code>\u95a2\u6570\u3092\u4f7f\u7528\u3057\u3066 \u3059\u3079\u3066\u306ePromise\u3092\u958b\u59cb\u3059\u308b\u3002</p> <pre><code>export async function fetchCardData() {\n  try {\n    const invoiceCountPromise = sql`SELECT COUNT(*) FROM invoices`;\n    const customerCountPromise = sql`SELECT COUNT(*) FROM customers`;\n    const invoiceStatusPromise = sql`SELECT\n         SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) AS \"paid\",\n         SUM(CASE WHEN status = 'pending' THEN amount ELSE 0 END) AS \"pending\"\n         FROM invoices`;\n\n    const data = await Promise.all([\n      invoiceCountPromise,\n      customerCountPromise,\n      invoiceStatusPromise,\n    ]);\n    // ...\n  }\n}\n</code></pre> <p>\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u5411\u4e0a\u3002</p>"},{"location":"JS/nextjs/ne-first/","title":"\u306f\u3058\u3081\u306b","text":""},{"location":"JS/nextjs/ne-first/#what-is-nextjs","title":"What is Next.js","text":"<p>HP\u3088\u308a Next.js</p> <p>Next.js \u306f\u3001\u30d5\u30eb\u30b9\u30bf\u30c3\u30af Web \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3059\u308b\u305f\u3081\u306e React \u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3059\u3002  React Components \u3092\u4f7f\u7528\u3057\u3066\u30e6\u30fc\u30b6\u30fc \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u3092\u69cb\u7bc9\u3057\u3001 Next.js \u3092\u8ffd\u52a0\u6a5f\u80fd\u3068\u6700\u9069\u5316\u306b\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <p>Next.js...React\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af \u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af...\u3053\u3053\u3067\u306fWeb\u30a2\u30d7\u30ea\u3092\u52b9\u7387\u7684\u306b\u958b\u767a\u3059\u308b\u305f\u3081\u571f\u53f0</p>"},{"location":"JS/nextjs/ne-first/#nextjsreact","title":"Next.js\u3068React\u306e\u9055\u3044\uff08\u4e21\u8005\u306e\u5171\u751f\u306b\u3064\u3044\u3066\u89e3\u8aac\uff09","text":"<p>Next.js\u3068React\u306e\u9055\u3044\uff08\u4e21\u8005\u306e\u5171\u751f\u306b\u3064\u3044\u3066\u89e3\u8aac\uff09</p> <p>javascript\u306e\u958b\u767a\u529b\u304c\u3001React\u306e\u3088\u3046\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3084\u3001Next.js\u306e\u3088\u3046\u306a\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u304c\u767b\u5834\u3057\u3066\u9ad8\u307e\u3063\u305f\u3002</p>"},{"location":"JS/nextjs/ne-first/#nextjs","title":"Next.js\u3068\u306f","text":"<p>Next.js\u306f2016\u5e74\u306bVercel\u793e\u304b\u3089\u30ea\u30ea\u30fc\u30b9\u3002 \u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u306eReact\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3002 \u4f8b) Twitch\u3001TikTok\u3001Uber\u306a\u3069</p>"},{"location":"JS/nextjs/ne-first/#react","title":"React\u3068\u306f","text":"<p>React\u306f\u3001\u52d5\u7684\u306a\u30e6\u30fc\u30b6\u30fc\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306e\u69cb\u7bc9\u306b\u4fbf\u5229\u306aJavaScript\u30e9\u30a4\u30d6\u30e9\u30ea\u3002 \u30a6\u30a7\u30d6\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3060\u3051\u3067\u306a\u304f\u3001React Native\u3092\u4f7f\u3063\u3066\u30e2\u30d0\u30a4\u30eb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd  </p>"},{"location":"JS/nextjs/ne-first/#nextjsreact_1","title":"Next.js\u3068React\u306e\u6bd4\u8f03","text":""},{"location":"JS/nextjs/ne-first/#startup","title":"Startup","text":"<p>Next.js</p> <pre><code>npx create-next-app\n</code></pre> <p>React</p> <pre><code>npx create-react-app new-app\n</code></pre> <p>Next.js\u304cReact\u3092\u30d9\u30fc\u30b9\u306b\u3057\u3066\u3044\u308b\u3002 React &lt; Next.js Next.js\u3067\u306f\u3055\u3089\u306b\u4e00\u6b69\u9032\u3093\u3067\u3001\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3001\u30b3\u30fc\u30c9\u5206\u5272\u3001\u30d7\u30ea\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3001API\u30b5\u30dd\u30fc\u30c8\u306a\u3069\u306e\u6a5f\u80fd\u3092\u3059\u3050\u306b\u5229\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002</p> <p>\u4ee5\u4e0b\u3001\u307e\u3068\u3081</p> <p>Next.js\u306f\u3001\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3092\u5411\u4e0a\u3055\u305b\u308b\u69cb\u9020\u3068\u30c4\u30fc\u30eb\u3067\u3001React\u306e\u6a5f\u80fd\u306e\u5f37\u5316\u306b\u6210\u529f\u3057\u3066\u3044\u307e\u3059\u3002 \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3001\u30b3\u30fc\u30c9\u5206\u5272\u3001\u753b\u50cf\u6700\u9069\u5316\u306a\u3069\u306e\u6a5f\u80fd\u304cNext.js\u306b\u7d44\u307f\u8fbc\u307e\u308c\u3066\u304a\u308a\u3001 \u958b\u767a\u306e\u969b\u306b\u624b\u52d5\u3067\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002 \u3053\u308c\u3089\u306e\u6a5f\u80fd\u306b\u3088\u308a\u3001Next.js\u306f\u4f7f\u3044\u3084\u3059\u3044\u9078\u629e\u80a2\u3067\u3042\u308a\u3001 \u3059\u3050\u306b\u305d\u306e\u5f8c\u306e\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u306b\u7740\u624b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002 Next.js\u306f\u3001\u3055\u307e\u3056\u307e\u306a\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u5099\u3048\u3066\u3044\u308b\u305f\u3081\u3001 \u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3084\u3001 \u9759\u7684\u751f\u6210\u3068Node.js\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3092\u7d44\u307f\u5408\u308f\u305b\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u9069\u3057\u3066\u3044\u307e\u3059\u3002 \u307e\u305f\u3001\u6700\u9069\u5316\u6a5f\u80fd\u306b\u3088\u308a\u3001Next.js\u306fEC\u306e\u3088\u3046\u306a\u9ad8\u901f\u6027\u304c\u8981\u6c42\u3055\u308c\u308b\u30b5\u30a4\u30c8\u306b\u3082\u5411\u3044\u3066\u3044\u307e\u3059\u3002 React\u306f\u3001\u5805\u7262\u306a\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\u3068\u62e1\u5f35\u3092\u652f\u63f4\u3059\u308bJavaScript\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002 \u307e\u305f\u3001\u305d\u306e\u69cb\u6587\u306f\u308f\u304b\u308a\u3084\u3059\u304f\u3001\u7279\u306bJavaScript\u306e\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3092\u6301\u3064\u958b\u767a\u8005\u306b\u3068\u3063\u3066\u306f\u6709\u7528\u3067\u3059\u3002 \u3055\u3089\u306b\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u4f7f\u7528\u3059\u308b\u30c4\u30fc\u30eb\u3084\u305d\u306e\u8a2d\u5b9a\u65b9\u6cd5\u3092\u4e8b\u7d30\u304b\u306b\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"JS/nextjs/ne-pages/","title":"\u30ec\u30a4\u30a2\u30a6\u30c8\u3068\u30da\u30fc\u30b8","text":""},{"location":"JS/nextjs/ne-pages/#_1","title":"\u30cd\u30b9\u30c8\u3055\u308c\u305f\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0","text":"<p>Next.js \u306f\u3001\u30d5\u30a9\u30eb\u30c0\u30fc\u3092\u4f7f\u7528\u3057\u3066\u30cd\u30b9\u30c8\u3055\u308c\u305f\u30eb\u30fc\u30c8\u3092\u4f5c\u6210\u3059\u308b\u30d5\u30a1\u30a4\u30eb \u30b7\u30b9\u30c6\u30e0 \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002  <code>layout.tsx</code>\u304a\u3088\u3073<code>page.tsx</code>\u3092\u4f7f\u7528\u3057\u3066\u3001\u30eb\u30fc\u30c8\u3054\u3068\u306b\u500b\u5225\u306e UI \u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002 \u30cd\u30b9\u30c8\u3055\u308c\u305f\u30eb\u30fc\u30c8\u3092\u4f5c\u6210\u3059\u308b\u306b\u306f\u3001\u30d5\u30a9\u30eb\u30c0\u30fc\u3092\u4e92\u3044\u306b\u30cd\u30b9\u30c8\u3057\u3001<code>page.tsx</code>\u305d\u306e\u4e2d\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002</p> <p>\u4f8b) \u4ee5\u4e0b\u306e\u30d5\u30a9\u30eb\u30c0\u69cb\u6210\u306e\u5834\u5408\u3001 <code>http://localhost:3000/dashboard/invoices</code> \u306b\u3066\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b</p> <p></p>"},{"location":"JS/nextjs/ne-pages/#_2","title":"\u30ec\u30a4\u30a2\u30a6\u30c8","text":"<p>Next.js \u3067\u306f\u3001\u7279\u5225\u306a<code>layout.tsx</code>\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066\u3001 \u8907\u6570\u306e\u30da\u30fc\u30b8\u3067\u5171\u6709\u3055\u308c\u308b UI \u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002  </p> <p>\u4f5c\u6210\u3057\u305f\u30d5\u30a9\u30eb\u30c0\u4ee5\u4e0b\u306epage\u3067layout.tsx\u304c\u9069\u7528\u3055\u308c\u308b\u3002</p> <p>\u4e00\u968e\u5c64\u524d\u306e\u30d5\u30a9\u30eb\u30c0\u3067\u3082<code>layout.tsx</code>\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u306f\u3001 \u30ec\u30a4\u30a2\u30a6\u30c8\u306f2\u3064\u9069\u7528\u3055\u308c\u308b\u3002(\u4e21\u65b9\u306e\u30ec\u30a4\u30a2\u30a6\u30c8\u304c\u9069\u7528\u3055\u308c\u308b\u3002)</p> <p><code>/app/layout.tsx</code>\u306f\u30eb\u30fc\u30c8\u30ec\u30a4\u30a2\u30a6\u30c8\u3068\u547c\u3070\u308c\u3001\u5fc5\u9808\u3068\u306a\u308b\u3002 \u3053\u308c\u306f\u5168\u3066\u306e\u30da\u30fc\u30b8\u3067\u5171\u6709\u3055\u308c\u308b\u3002 /app/layout.tsx <pre><code>import '@/app/ui/global.css';\nimport { inter } from '@/app/ui/fonts';\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body className={`${inter.className} antialiased`}&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  );\n}\n</code></pre></p>"},{"location":"JS/nextjs/ne-pages/#_3","title":"\u90e8\u5206\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0","text":"<p>\u540c\u3058\u968e\u5c64\u4ee5\u4e0b\u3067<code>layout.tsx</code>\u3092\u4f7f\u3044\u307e\u308f\u3057\u3066\u3044\u305f\u5834\u5408\u3001 \u30ca\u30d3\u30b2\u30fc\u30b7\u30e7\u30f3\u6642\u306b<code>page.tsx</code>\u306e\u30da\u30fc\u30b8\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306e\u307f\u304c\u66f4\u65b0\u3055\u308c\u3066\u3001 \u30ec\u30a4\u30a2\u30a6\u30c8\u306f\u518d\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u306a\u3044\u3053\u3068</p>"},{"location":"JS/nextjs/ne-pages/#_4","title":"\u30da\u30fc\u30b8\u9593\u306e\u79fb\u52d5","text":"<p>a\u30bf\u30b0...\u30da\u30fc\u30b8\u9077\u79fb\u6642\u306b\u30da\u30fc\u30b8\u5168\u4f53\u304c\u66f4\u65b0\u3055\u308c\u3066\u3057\u307e\u3046</p> <p>Next.js \u3067\u306f\u3001<code>&lt;Link /&gt;</code>\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u4f7f\u7528\u3057\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5185\u306e\u30da\u30fc\u30b8\u9593\u3092\u30ea\u30f3\u30af\u3067\u304d\u307e\u3059\u3002 \u2192a\u30bf\u30b0\u306e\u4ee3\u308f\u308a\u306b\u3053\u308c\u3092\u4f7f\u3046 \u2192\u30da\u30fc\u30b8\u304c\u66f4\u65b0\u3055\u308c\u308b\u3053\u3068\u304c\u7121\u304f\u306a\u3063\u305f\u3002 <code>&lt;Link href=\"\u2026\"&gt;</code></p>"},{"location":"JS/nextjs/ne-pages/#_5","title":"\u81ea\u52d5\u30b3\u30fc\u30c9\u5206\u5272\u3068\u30d7\u30ea\u30d5\u30a7\u30c3\u30c1","text":"<p>Next.js\u3067\u306f\u30eb\u30fc\u30c8\u3054\u3068\u306b\u30a2\u30d7\u30ea\u3092\u81ea\u52d5\u7684\u306b\u30b3\u30fc\u30c9\u5206\u5272\u3057\u3066\u3044\u308b\u3002 \u521d\u671f\u8aad\u307f\u8fbc\u307f\u6642\u3001\u3059\u3079\u3066\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b3\u30fc\u30c9\u3092\u8aad\u307f\u8fbc\u3080\u3002 \u2192 \u7279\u5b9a\u306e\u30da\u30fc\u30b8\u3067\u30a8\u30e9\u30fc\u304c\u8d77\u304d\u3066\u3082\u30a2\u30d7\u30ea\u306e\u6b8b\u308a\u306e\u90e8\u5206\u306f\u5f15\u304d\u7d9a\u304d\u52d5\u4f5c\u3059\u308b</p> <p>\u672c\u756a\u74b0\u5883\u3067\u306f<code>&lt;Link&gt;</code>\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u304c\u30d6\u30e9\u30a6\u30b6\u306b\u8868\u793a\u3055\u308c\u308b\u305f\u3073\u306b \u30ea\u30f3\u30af\u5148\u306e\u30da\u30fc\u30b8\u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8aad\u307f\u8fbc\u3080\u3002 \u305d\u306e\u305f\u3081\u3001\u30da\u30fc\u30b8\u9077\u79fb\u304c\u77ac\u6642\u306b\u884c\u308f\u308c\u3066\u3044\u308b\u3088\u3046\u306b\u611f\u3058\u308b\u3002</p>"},{"location":"JS/nextjs/ne-pages/#_6","title":"\u73fe\u5728\u306e\u30d1\u30b9\u3092\u53d6\u5f97\u3059\u308b","text":"<pre><code>'use client'; // \u8a18\u8f09\u3057\u306a\u3044\u3068\u6012\u3089\u308c\u308b\n\nimport { usePathname } from 'next/navigation';\n\nexport default function NavLinks() {\n  const pathname = usePathname();\n  // ...\n}\n</code></pre> <p><code>http://localhost:3000/dashboard/customers</code> \u304c\u73fe\u5728\u306e\u30d1\u30b9\u306a\u3089\u3001 <code>pathname</code>\u306b\u306f<code>/dashboard/customers</code>\u304c\u5165\u308b\u3002  </p> <p><code>use client</code>\u306f\u3001\u30b5\u30fc\u30d0\u30fc \u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8 \u30e2\u30b8\u30e5\u30fc\u30eb\u9593\u306e\u5883\u754c\u3092\u5ba3\u8a00\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002 \u2192 App Router \u306e\u3059\u3079\u3066\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u304c\u30b5\u30fc\u30d0\u30fc \u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3067\u3042\u308a\u3001\u3053\u308c\u3089\u306e API \u306f\u5229\u7528\u3067\u304d\u306a\u3044\u305f\u3081 \u2192 import\u3059\u308b\u3068\u3001\u5b50\u306b\u3082\u5f71\u97ff\u304c\u3042\u308b\u305f\u3081\u3001\u308f\u3056\u308f\u3056\u5404\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3067\u5ba3\u8a00\u3059\u308b\u5fc5\u8981\u306f\u306a\u3044\u3002  </p> <p>Using Client Components in Next.js</p>"},{"location":"JS/nextjs/ne-render/","title":"\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0","text":""},{"location":"JS/nextjs/ne-render/#_1","title":"\u9759\u7684\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3068\u306f","text":"<p>\u9759\u7684\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3067\u306f\u3001 \u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u3068\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u306f\u3001\u30d3\u30eb\u30c9\u6642 (\u30c7\u30d7\u30ed\u30a4\u6642) \u307e\u305f\u306f \u30c7\u30fc\u30bf\u306e\u518d\u691c\u8a3c\u6642\u306b\u30b5\u30fc\u30d0\u30fc\u4e0a\u3067\u884c\u308f\u308c\u308b\u3002</p> <p>\u9759\u7684\u306a\u30d6\u30ed\u30b0\u6295\u7a3f\u3084\u88fd\u54c1\u30da\u30fc\u30b8\u306a\u3069\u3001 \u30c7\u30fc\u30bf\u306e\u306a\u3044UI\u3084\u30e6\u30fc\u30b6\u30fc\u9593\u3067\u5171\u6709\u3055\u308c\u308b\u30c7\u30fc\u30bf\u306b\u306f\u4fbf\u5229\u3002</p> <p>\u5b9a\u671f\u7684\u306b\u66f4\u65b0\u3055\u308c\u308b\u30d1\u30fc\u30bd\u30ca\u30e9\u30a4\u30ba\u3055\u308c\u305f\u30c7\u30fc\u30bf\u3092\u6301\u3064 \u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306b\u306f\u9069\u3055\u306a\u3044\u53ef\u80fd\u6027\u304c\u3042\u308b\u3002</p>"},{"location":"JS/nextjs/ne-render/#_2","title":"\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3068\u306f","text":"<p>\u9759\u7684\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u306e\u9006\u3002 \u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30c7\u30fc\u30bf\u3084\u983b\u7e41\u306b\u66f4\u65b0\u3055\u308c\u308b\u30c7\u30fc\u30bf\u3092\u8868\u793a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002</p> <p>\u30ea\u30af\u30a8\u30b9\u30c8\u6642\u306e\u60c5\u5831 \u52d5\u7684\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001 Cookie \u3084 URL \u691c\u7d22\u30d1\u30e9\u30e1\u30fc\u30bf\u306a\u3069\u3001 \u30ea\u30af\u30a8\u30b9\u30c8\u6642\u306b\u306e\u307f\u77e5\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3002</p> <p>Warning</p> <p>1\u3064\u306e\u30c7\u30fc\u30bf\u8981\u6c42\u304c\u307b\u304b\u306e\u5168\u3066\u306e\u8981\u6c42\u3088\u308a\u3082\u9045\u3044\u5834\u5408\u3001\u30a2\u30d7\u30ea\u306e\u901f\u5ea6\u306f\u6700\u3082\u9045\u3044\u30c7\u30fc\u30bf\u53d6\u5f97\u901f\u5ea6\u3068\u540c\u3058\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u3002</p>"},{"location":"JS/nextjs/ne-render/#_3","title":"\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0","text":"<p>\u30eb\u30fc\u30c8\u3092\u5c0f\u3055\u306a\u300c\u30c1\u30e3\u30f3\u30af\u300d\u306b\u5206\u5272\u3057\u3001 \u6e96\u5099\u304c\u6574\u3046\u3068\u3001\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u6bb5\u968e\u7684\u306b\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\u304c\u3067\u304d\u308b\u8ee2\u9001\u6280\u8853</p> <p></p> <p>Success</p> <p>\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\u306b\u3088\u308a\u3001\u4f4e\u901f\u306a\u30c7\u30fc\u30bf\u8981\u6c42\u306b\u3088\u3063\u3066\u30da\u30fc\u30b8\u5168\u4f53\u304c\u30d6\u30ed\u30c3\u30af\u3055\u308c\u308b\u3053\u3068\u3092\u9632\u3050\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"JS/nextjs/ne-render/#_4","title":"\u5b9f\u88c5\u65b9\u6cd5","text":"<p><code>/app/dashboard</code>\u30d5\u30a9\u30eb\u30c0\u5185\u306b\u3001 <code>loading.tsx</code>\u3092\u4f5c\u6210 <pre><code>export default function Loading() {\n  return &lt;div&gt;Loading...&lt;/div&gt;;\n}\n</code></pre></p> <p>\u8aad\u307f\u8fbc\u307f\u4e2d\u306f\u300cLoading...\u300d\u3068\u8868\u793a\u3055\u308c\u3066\u304a\u308a\u3001 </p> <p>\u8aad\u307f\u8fbc\u307f\u5b8c\u4e86\u5f8c\u306b\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u305f </p> <p>\u30da\u30fc\u30b8 \u30b3\u30f3\u30c6\u30f3\u30c4\u306e\u8aad\u307f\u8fbc\u307f\u4e2d\u306b\u4ee3\u308f\u308a\u306b\u8868\u793a\u3055\u308c\u308b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af UI \u3092\u4f5c\u6210\u51fa\u6765\u308b\u3002 \u30e6\u30fc\u30b6\u30fc\u306f\u30da\u30fc\u30b8\u306e\u5b8c\u4e86\u3092\u5f85\u305f\u305a\u306b\u5225\u753b\u9762\u306b\u884c\u304f\u306a\u3069\u3001 \u8aad\u307f\u8fbc\u307f\u306b\u95a2\u4fc2\u306a\u3044\u7b87\u6240\u306e\u64cd\u4f5c\u306f\u3067\u304d\u308b\u3002</p> <p>\u30b9\u30b1\u30eb\u30c8\u30f3\u3092\u4f7f\u3046\u306e\u3082\u3042\u308a\u3002 </p> <p>Success</p> <p><code>page.tsx</code>\u3067\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\u3059\u308b\u3088\u308a\u3001 \u7279\u5b9a\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3067\u30c7\u30fc\u30bf\u3092fetch\u3057\u3066loading\u3059\u308b\u65b9\u304c\u3001 \u4ed6\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306b\u5f71\u97ff\u304c\u51fa\u305a\u3001\u826f\u3044\u3002 </p> <p>\u30b0\u30e9\u30d5\u306e\u4f5c\u6210\u306b\u591a\u5927\u306a\u30c7\u30fc\u30bf\u8aad\u307f\u8fbc\u307f\u6642\u9593\u304c\u304b\u304b\u3063\u3066\u304a\u308a\u3001 \u30da\u30fc\u30b8\u5168\u4f53\u3092\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\u3057\u305f\u3089\u8aad\u307f\u8fbc\u307f\u304c\u5b8c\u4e86\u3057\u3066\u3044\u308b\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3082\u8868\u793a\u3055\u308c\u306a\u304f\u306a\u3063\u3066\u3044\u308b\u306e\u3067 \u7279\u5b9a\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306e\u307f\u3067\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\u3092\u884c\u3063\u3066\u3044\u308b\u3002 </p>"},{"location":"JS/nextjs/ne-render/#suspense","title":"Suspense","text":"<p><code>&lt;Suspense&gt;</code> \u3092\u4f7f\u3046\u3053\u3068\u3067\u3001\u5b50\u8981\u7d20\u304c\u8aad\u307f\u8fbc\u307f\u3092\u5b8c\u4e86\u3059\u308b\u307e\u3067\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u8868\u793a\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <p><pre><code>&lt;Suspense fallback={&lt;Loading /&gt;}&gt;\n  &lt;SomeComponent /&gt;\n&lt;/Suspense&gt;\n</code></pre> \u4f8b\u3048\u3070\u3001\u4eca\u307e\u3067pages.tsx\u3067\u30c7\u30fc\u30bf\u3092\u30d5\u30a7\u30c3\u30c1\u3057\u3066\u3044\u305f\u3068\u3059\u308b\u3002 \u305d\u306e\u30d5\u30a7\u30c3\u30c1\u3092<code>SomeComponent</code>\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u5185\u3067\u884c\u3046\u3002 \u8aad\u307f\u8fbc\u307f\u4e2d\u306f<code>Loading</code>\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u304c\u8868\u793a\u3055\u308c\u308b\u3002</p>"},{"location":"JS/nextjs/ne-render/#_5","title":"\u307e\u3068\u3081\u3066\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0","text":"<p>Card\u3068\u304b\u306e\u5834\u5408\u3001\u8aad\u307f\u8fbc\u307f\u304c\u7d42\u308f\u3063\u305f\u3082\u306e\u304b\u3089\u9806\u6b21\u8868\u793a\u3057\u3066\u3044\u304f\u3068\u3057\u305f\u3089\u3001 \u8868\u793a\u304c\u30d0\u30e9\u30d0\u30e9\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u3001\u8fd4\u3063\u3066\u898b\u3065\u3089\u304f\u306a\u3063\u3066\u3057\u307e\u3046\u3053\u3068\u304c\u3042\u308b\u3002</p> <p>\u305d\u306e\u5834\u5408\u306f\u3001\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3059\u308b\u3002 \u305d\u3046\u3057\u305f\u5834\u5408\u3001\u5168\u3066\u306e\u8aad\u307f\u8fbc\u307f\u304c\u5b8c\u4e86\u3057\u305f\u6bb5\u968e\u3067\u8868\u793a\u3055\u308c\u308b\u3002</p> <p>/app/dashboard/page.tsx <pre><code>&lt;Suspense fallback={&lt;CardsSkeleton /&gt;}&gt;\n    &lt;CardWrapper /&gt;\n&lt;/Suspense&gt;\n</code></pre></p> <p>/app/ui/dashboard/card.tsx <pre><code>// ...\nimport { fetchCardData } from '@/app/lib/data';\n\n// ...\n\nexport default async function CardWrapper() {\n  const {\n    numberOfInvoices,\n    numberOfCustomers,\n    totalPaidInvoices,\n    totalPendingInvoices,\n  } = await fetchCardData();\n\n  return (\n    &lt;&gt;\n      &lt;Card title=\"Collected\" value={totalPaidInvoices} type=\"collected\" /&gt;\n      &lt;Card title=\"Pending\" value={totalPendingInvoices} type=\"pending\" /&gt;\n      &lt;Card title=\"Total Invoices\" value={numberOfInvoices} type=\"invoices\" /&gt;\n      &lt;Card\n        title=\"Total Customers\"\n        value={numberOfCustomers}\n        type=\"customers\"\n      /&gt;\n    &lt;/&gt;\n  );\n}\n</code></pre></p>"},{"location":"JS/nextjs/ne-render/#_6","title":"\u30b5\u30b9\u30da\u30f3\u30b9\u306e\u5883\u754c\u7dda\u3092\u3069\u3053\u306b\u7f6e\u304f\u304b","text":"<ol> <li>\u30da\u30fc\u30b8\u306e\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\u4e2d\u306b\u30e6\u30fc\u30b6\u30fc\u306b\u3069\u306e\u3088\u3046\u306b\u30da\u30fc\u30b8\u3092\u4f53\u9a13\u3057\u3066\u3082\u3089\u3044\u305f\u3044\u304b\u3002</li> <li>\u512a\u5148\u3057\u305f\u3044\u30b3\u30f3\u30c6\u30f3\u30c4\u3002</li> <li>\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u304c\u30c7\u30fc\u30bf\u53d6\u5f97\u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b\u5834\u5408\u3002</li> </ol>"},{"location":"JS/nextjs/ne-vercle/","title":"Vercel","text":"<p>\u3053\u3061\u3089\u306b\u30a2\u30af\u30bb\u30b9 vercel.com/signup</p>"},{"location":"JS/nextjs/ne-vercle/#_1","title":"\u624b\u9806","text":"<ol> <li>Github\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u9078\u629e\u3057\u3066import</li> <li>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u540d\u524d\u3092\u4ed8\u3051\u3066Deploy</li> <li>Postgres\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3059\u308b<ul> <li>Dashboard</li> <li>Strage\u30bf\u30d6</li> <li>Postgres\u3092\u9078\u629e</li> <li>\u898f\u7d04\u306b\u540c\u610f\u3057\u3066Create</li> <li>Project\u3068\u63a5\u7d9a\u3059\u308b\u300cConnect Project\u300d</li> <li>.env.local\u30bf\u30d6\u3092\u8868\u793a\u3057\u3001\u300cCopy Snippet\u300d\u3067\u30b3\u30d4\u30fc\u3059\u308b</li> <li>.env\u30d5\u30a1\u30a4\u30eb\u306b\u8cbc\u308a\u4ed8\u3051\u308b</li> </ul> </li> </ol> <ol> <li>Vercel Postgres SDK\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb <pre><code>pnpm i @vercel/postgres\n</code></pre></li> </ol>"},{"location":"network/network/","title":"\u7121\u7ddaLAN\u3092\u30d7\u30ed\u30df\u30b9\u30ad\u30e3\u30b9\u30e2\u30fc\u30c9\u306b\u3059\u308b\u65b9\u6cd5","text":"<p>\u300c\u30d7\u30ed\u30df\u30b9\u30ad\u30e3\u30b9\u30e2\u30fc\u30c9\u300d\u306b\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u3001\u81ea\u5206\u5b9b\u3066\u3067\u306a\u3044\u30d1\u30b1\u30c3\u30c8\u3082\u508d\u53d7\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002 \u3064\u307e\u308a\u3001\u901a\u5e38\u306f\u300ePC-LAN\u300f\u306e\u30d1\u30b1\u30c3\u30c8\u3057\u304b\u78ba\u8a8d\u3067\u304d\u306a\u3044\u304c\u3001\u300eiPhone-LAN\u300f\u306e\u30d1\u30b1\u30c3\u30c8\u3082\u78ba\u8a8d\u3067\u304d\u308b\u3068\u3044\u3046\u3053\u3068</p> <p>\u30c7\u30d0\u30a4\u30b9\u30de\u30cd\u30fc\u30b8\u30e3 &gt; \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a2\u30c0\u30d7\u30bf &gt; \u4f7f\u7528\u3057\u3066\u3044\u308b\u30a2\u30c0\u30d7\u30bf\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u958b\u304f  </p> <p></p> <p>\u3053\u306e\u8a2d\u5b9a\u3067OK\u3092\u62bc\u4e0b\u3057\u3066\u3001\u300c\u30c7\u30d0\u30a4\u30b9\u306e\u7121\u52b9\u5316\u300d\u2192\u300c\u30c7\u30d0\u30a4\u30b9\u306e\u6709\u52b9\u5316\u300d\u3067\u518d\u8d77\u52d5</p>"},{"location":"network/network/#iphone","title":"iPhone\u306e\u30cd\u30a4\u30c6\u30a3\u30d6\u30a2\u30d7\u30ea\u306e\u901a\u4fe1\u3092\u78ba\u8a8d\u3059\u308b","text":"<p>iPhone\u306eMAC\u30a2\u30c9\u30ec\u30b9\u3092\u78ba\u8a8d\u3059\u308b</p> <p>WireShark\u3092\u8d77\u52d5\u3057\u3066\u300cWifi\u300d\u3092\u62bc\u4e0b\u3059\u308b\u3002</p> <p></p>"},{"location":"python/py-django-01/","title":"Django","text":""},{"location":"python/py-django-01/#_1","title":"\u306f\u3058\u3081\u306b","text":"<p>Django\u306f\u30aa\u30fc\u30eb\u30a4\u30f3\u30ef\u30f3\u306e\u30c4\u30fc\u30eb\u306a\u306e\u3067\u3001\u500b\u4eba\u958b\u767a\u3068\u3057\u3066\u306f\u3042\u307e\u308a\u52b4\u529b\u3082\u306a\u304f\u6700\u9069\u306a\u306e\u3067\u306f\uff1f \u5f8c\u306f\u51e6\u7406\u901f\u5ea6\u306e\u554f\u984c</p> <p>Django \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</p>"},{"location":"python/py-django-01/#_2","title":"\u30af\u30a4\u30c3\u30af\u30b9\u30bf\u30fc\u30c8","text":"<p>pip <pre><code>pip install django \n</code></pre></p> <p>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u958b\u59cb\u3059\u308b\u3002 <pre><code>django-admin startproject mysite\n</code></pre> \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u3002 <pre><code>cd mysite\npython manage.py startapp polls\n</code></pre></p> <p>Note</p> <p>\u30a2\u30d7\u30ea...\u4f55\u304b\u3092\u884c\u3046 Web \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3 \u30d7\u30ed\u30b8\u30a7\u30af\u30c8...\u7279\u5b9a\u306e\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u306e\u69cb\u6210\u3068\u30a2\u30d7\u30ea\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3</p> <p>\u5b9f\u884c <pre><code>python manage.py runserver\n\n# \u30db\u30b9\u30c8:\u30dd\u30fc\u30c8\u3092\u6307\u5b9a\u3057\u3066\u306e\u8d77\u52d5\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u304c\u3001\u30db\u30b9\u30c8\u8a2d\u5b9a\u304c\u5225\u9014\u5fc5\u8981\n# python manage.py runserver 192.168.0.18:8001\n</code></pre></p> <ol> <li>\u30b7\u30ea\u30a2\u30e9\u30a4\u30b6\u306e\u4f5c\u6210:</li> </ol> <p><code>testapp</code> \u5185\u306b <code>serializers.py</code> \u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30b7\u30ea\u30a2\u30e9\u30a4\u30b6\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002</p> <pre><code>from rest_framework import serializers\n\nclass TestSerializer(serializers.Serializer):\n    data = serializers.CharField(max_length=100)\n</code></pre> <ol> <li>\u30d3\u30e5\u30fc\u306e\u4f5c\u6210:</li> </ol> <p><code>testapp</code> \u5185\u306b <code>views.py</code> \u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30d3\u30e5\u30fc\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002</p> <pre><code> from rest_framework.views import APIView\n from rest_framework.response import Response\n from rest_framework import status\n\n class TestView(APIView):\n     def get(self, request):\n         return Response(\"GET OK\")\n\n     def post(self, request, *args, **kwargs):\n         data = request.data['message']\n         return Response(data)\n</code></pre> <ol> <li>URL\u30d1\u30bf\u30fc\u30f3\u306e\u8a2d\u5b9a:</li> </ol> <p><code>testapp</code> \u5185\u306e <code>urls.py</code> \u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u3001\u30d3\u30e5\u30fc\u3068URL\u3092\u95a2\u9023\u4ed8\u3051\u307e\u3059\u3002</p> <pre><code>from django.urls import path\nfrom .views import TestView\n\nurlpatterns = [\n    path('api/test/', TestView.as_view(), name='test-api'),\n]\n</code></pre> <ol> <li>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8URL\u8a2d\u5b9a\u306e\u66f4\u65b0:</li> </ol> <p>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e <code>urls.py</code> \u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3066\u3001\u30a2\u30d7\u30ea\u306eURL\u3092\u30a4\u30f3\u30af\u30eb\u30fc\u30c9\u3057\u307e\u3059\u3002</p> <pre><code>from django.contrib import admin\nfrom django.urls import path, include\n\nurlpatterns = [\n    path('admin/', admin.site.urls),\n    path('', include('testapp.urls')),\n]\n</code></pre> <ol> <li>\u30d6\u30e9\u30a6\u30ba\u53ef\u80fd\u306aAPI\u30da\u30fc\u30b8\u3092\u7121\u52b9\u306b\u3059\u308b:</li> </ol> <p>settings.py \u30d5\u30a1\u30a4\u30eb\u5185\u3067\u3001REST_FRAMEWORK \u30bb\u30af\u30b7\u30e7\u30f3\u306b\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u3066\u3001\u30d6\u30e9\u30a6\u30ba\u53ef\u80fd\u306aAPI\u30da\u30fc\u30b8\u3092\u7121\u52b9\u306b\u3057\u307e\u3059\u3002</p> <p><pre><code> REST_FRAMEWORK = {\n     'DEFAULT_RENDERER_CLASSES': (\n         'rest_framework.renderers.JSONRenderer',\n     ),\n     'DEFAULT_PARSER_CLASSES': (\n         'rest_framework.parsers.JSONParser',\n     ),\n }\n</code></pre> \u3053\u308c\u306b\u3088\u308a\u3001JSON\u5f62\u5f0f\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3060\u3051\u304c\u4f7f\u7528\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002</p> <ol> <li>\u30b5\u30fc\u30d0\u30fc\u306e\u8d77\u52d5:</li> </ol> <p>\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067Django\u958b\u767a\u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002</p> <pre><code>python manage.py runserver\n</code></pre> <p>\u3053\u308c\u3067\u3001<code>http://localhost:8000/api/test/</code> \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001GET\u30ea\u30af\u30a8\u30b9\u30c8\u3067\u300cGET OK\u300d\u3068\u3001POST\u30ea\u30af\u30a8\u30b9\u30c8\u3067\u9001\u4fe1\u3057\u305f\u30c7\u30fc\u30bf\u304c\u305d\u306e\u307e\u307e\u8fd4\u3055\u308c\u308bRESTful API\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002</p> <p>\u3053\u306e\u624b\u9806\u306b\u5f93\u3063\u3066\u3001\u6700\u5c0f\u9650\u306eDjango REST framework\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3084\u62e1\u5f35\u3092\u884c\u3044\u3001\u3055\u307e\u3056\u307e\u306aAPI\u3092\u5b9f\u88c5\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002</p>"},{"location":"python/py-django-01/#djangocorscross-origin-resource-sharing","title":"Django\u5074\u3067CORS\uff08Cross-Origin Resource Sharing\uff09\u3092\u8a31\u53ef\u3059\u308b\u306b\u306f","text":"<p>Django\u5074\u3067CORS\uff08Cross-Origin Resource Sharing\uff09\u3092\u8a31\u53ef\u3059\u308b\u306b\u306f\u3001<code>django-cors-headers</code> \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4f7f\u7528\u3057\u3066\u8a2d\u5b9a\u3092\u884c\u3046\u65b9\u6cd5\u304c\u4e00\u822c\u7684\u3067\u3059\u3002\u4ee5\u4e0b\u306e\u624b\u9806\u306b\u5f93\u3063\u3066\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002</p> <ol> <li><code>django-cors-headers</code> \u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb:</li> </ol> <p>\u307e\u305a\u3001Django\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b <code>django-cors-headers</code> \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002</p> <pre><code>pip install django-cors-headers\n</code></pre> <ol> <li>\u8a2d\u5b9a\u306e\u8ffd\u52a0:</li> </ol> <p><code>settings.py</code> \u30d5\u30a1\u30a4\u30eb\u5185\u3067\u3001<code>INSTALLED_APPS</code> \u306b <code>'corsheaders'</code> \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002</p> <pre><code>INSTALLED_APPS = [\n    # ...\n    'corsheaders',\n]\n</code></pre> <ol> <li>\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306e\u8ffd\u52a0:</li> </ol> <p><code>MIDDLEWARE</code> \u30ea\u30b9\u30c8\u5185\u306b\u3001<code>CorsMiddleware</code> \u3092 <code>'corsheaders.middleware.CorsMiddleware'</code> \u306e\u524d\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002</p> <pre><code>MIDDLEWARE = [\n    # ...\n    'corsheaders.middleware.CorsMiddleware',\n    # ...\n]\n</code></pre> <ol> <li>CORS\u8a2d\u5b9a\u306e\u30ab\u30b9\u30bf\u30de\u30a4\u30ba:</li> </ol> <p><code>settings.py</code> \u30d5\u30a1\u30a4\u30eb\u5185\u306b\u3001CORS\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306f\u57fa\u672c\u7684\u306a\u4f8b\u3067\u3059\u304c\u3001\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u8a2d\u5b9a\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3067\u304d\u307e\u3059\u3002</p> <pre><code>CORS_ALLOWED_ORIGINS = [\n    \"http://localhost:3000\",  # React\u30a2\u30d7\u30ea\u306e\u30a2\u30c9\u30ec\u30b9\uff08\u9069\u5b9c\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\uff09\n]\n\n# \u5fc5\u8981\u306b\u5fdc\u3058\u3066\u4ed6\u306eCORS\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3067\u304d\u307e\u3059\n</code></pre> <ol> <li> <p>\u6ce8\u610f\u4e8b\u9805:</p> </li> <li> <p><code>CORS_ALLOWED_ORIGINS</code> \u30ea\u30b9\u30c8\u306b\u306f\u3001\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u30aa\u30ea\u30b8\u30f3\uff08\u30c9\u30e1\u30a4\u30f3\uff09\u3092\u8ffd\u52a0\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> </li> <li><code>http://localhost:3000</code> \u306e\u90e8\u5206\u306f\u3001React\u30a2\u30d7\u30ea\u306e\u30a2\u30c9\u30ec\u30b9\u306b\u5408\u308f\u305b\u3066\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002</li> </ol> <p>\u3053\u308c\u3067\u3001Django\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304cCORS\u3092\u8a31\u53ef\u3057\u3001\u6307\u5b9a\u3057\u305f\u30aa\u30ea\u30b8\u30f3\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u3092\u53d7\u3051\u5165\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002CORS\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u305f\u5f8c\u306f\u3001Django\u30b5\u30fc\u30d0\u30fc\u3092\u518d\u8d77\u52d5\u3057\u3066\u8a2d\u5b9a\u304c\u53cd\u6620\u3055\u308c\u308b\u3053\u3068\u3092\u5fd8\u308c\u306a\u3044\u3067\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"python/py-django-01/#requirementstxt","title":"requirements.txt","text":"<pre><code>asgiref==3.7.2\nDjango==4.2.4\ndjango-cors-headers==4.2.0\ndjangorestframework==3.14.0\npytz==2023.3\nsqlparse==0.4.4\ntyping_extensions==4.7.1\ntzdata==2023.3\n</code></pre>"},{"location":"python/py-fastapi-01/","title":"FastAPI","text":""},{"location":"python/py-fastapi-01/#_1","title":"\u306f\u3058\u3081\u306b","text":"<p>FastAPI\u306fDjango\u3068\u7570\u306a\u308a\u5fc5\u8981\u3082\u306e\u3060\u3051\u3092\u53d6\u308a\u5165\u308c\u3066\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002 Django\u3067\u3044\u3046\u3068\u3001\u30b3\u30de\u30f3\u30c9\u4e00\u3064\u3067\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u6a5f\u80fd\u3084DB\u306eORM\u3001\u30eb\u30fc\u30bf\u30fc\u3084\u7ba1\u7406\u753b\u9762\u306a\u3069\u3001\u3042\u308a\u3068\u3042\u3089\u3086\u308b\u30c4\u30fc\u30eb\u3092\u63d0\u4f9b\u3057\u3066\u304f\u308c\u3001\u975e\u5e38\u306b\u4fbf\u5229\u3060\u304c\u3001\u305d\u306e\u53cd\u9762\u591a\u5c11\u91cd\u3044\u3002 FastAPI\u306f\u5fc5\u8981\u306a\u3082\u306e\u3092\u5fc5\u8981\u306a\u6642\u3060\u3051\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308c\u3070\u3044\u3044\u306e\u3067\u3001\u4f59\u8a08\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u7701\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u3002 \u4f8b\u3048\u3070DB\u304c\u4f7f\u3044\u305f\u3044\u3068\u304d\u306f<code>SQL Alchemy</code>\u3092\u3001\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u6a5f\u80fd\u3092\u4f7f\u3046\u306b\u306f<code>Alembic</code>\u3092\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308c\u3070\u3088\u3044\u3002 Django\u3067\u306f\u305d\u308c\u3089\u306e\u30c4\u30fc\u30eb\u3092\u7c21\u5358\u306b\u4f7f\u3048\u308b\u306e\u306b\u5bfe\u3057\u3066\u3001FastAPI\u306f\u4e00\u304b\u3089\u305d\u308c\u3089\u3092\u69cb\u7bc9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u3001\u53d6\u5f97\u30ec\u30d9\u30eb\u3068\u3057\u3066\u306f\u591a\u5c11\u9ad8\u304f\u306a\u308b\u3002 \u3053\u3053\u3067\u306f\u3001\u305d\u306eFastAPI\u3092\u307e\u3068\u3081\u308b\u3002</p>"},{"location":"python/py-fastapi-01/#_2","title":"\u30af\u30a4\u30c3\u30af\u30b9\u30bf\u30fc\u30c8","text":"<p>\u79c1\u304c\u3088\u304f\u4f7f\u3046\u6700\u5c0f\u9650\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306f<code>fastapi</code>\u3001<code>sqlalchemy</code>\u3001<code>uvicorn</code>\u3068\u306a\u308a\u3001\u305d\u308c\u3089\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u5f8c\u306e<code>requirements.txt</code>\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002</p> <p>requirements.txt <pre><code>annotated-types==0.6.0\nanyio==3.7.1\nclick==8.1.7\ncolorama==0.4.6\nexceptiongroup==1.2.0\nfastapi==0.105.0\ngreenlet==3.0.3\nh11==0.14.0\nidna==3.6\npydantic==2.5.3\npydantic_core==2.14.6\nsniffio==1.3.0\nSQLAlchemy==2.0.23\nstarlette==0.27.0\ntyping_extensions==4.9.0\n</code></pre></p> <p>\u4e0b\u8a18\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092main.py\u306b\u4f5c\u6210\u3057\u3066\u307f\u308b\u3002 GET\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u53d6\u3063\u305f\u3089\u6587\u5b57\u5217\u3092\u8fd4\u3059\u3060\u3051\u3002 main.py <pre><code>from fastapi import FastAPI\n\napp = FastAPI()\n\n@app.get(\"/\")\ndef read_root():\n    return {\"Hello\": \"World\"}\n</code></pre> \u4eee\u60f3\u74b0\u5883\u3092\u4f5c\u6210\u3057\u3066\u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5 <pre><code>uvicorn main:app --reload\n</code></pre></p> <p>Note</p> <p><code>--reload</code>\u3092\u30aa\u30d7\u30b7\u30e7\u30f3\u306b\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u30db\u30c3\u30c8\u30ea\u30ed\u30fc\u30c9\u3067\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002</p> <p>\u30db\u30b9\u30c8\u3084\u30dd\u30fc\u30c8\u3092\u6307\u5b9a\u3057\u305f\u3044\u5834\u5408\u306f\u4ee5\u4e0b <pre><code>uvicorn main:app --reload --host 0.0.0.0 --port 8000\n</code></pre></p>"},{"location":"python/py-fastapi-01/#pydantic","title":"Pydantic","text":"<p>\u30bf\u30a4\u30d7\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u4f7f\u3046\u3002\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u578b\u306a\u3069\u3092\u5224\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002 <pre><code>from fastapi import FastAPI, Query\n\napp = FastAPI()\n\n@app.get(\"/\")\ndef read_root(\n    name: str = Query(\n        ..., \n        title=\"\u4eba\u306e\u540d\u524d\", \n        description=\"\u3053\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u306f\u4eba\u306e\u540d\u524d\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\", \n        example=\"Yoko\"\n    ),\n):\n    return {\"Hello\": name}\n</code></pre> <code>localhost:8000/?name=Takeru</code>\u3067<code>Takeru</code>\u3068\u3044\u3046\u6587\u5b57\u5217\u3092\u53d7\u3051\u53d6\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002</p> <p>\u3069\u3061\u3089\u304b\u306e\u578b\u3092\u8a31\u5bb9\u3059\u308b <pre><code>from typing import Union\n...\nuser_id: Union[str, None]\n</code></pre> \u5fc5\u9808\u30c1\u30a7\u30c3\u30af\u306a\u3057 <pre><code>user_id: str | None = None\n</code></pre> \u72ec\u81ea\u306e\u578b\u3092\u5ba3\u8a00\u3059\u308b\u5834\u5408 <pre><code>from pydantic import BaseModel\n\nclass PersonalData(BaseModel):\n    name: str = \"\"\n    age: int = 0\n\n@app.get(\"/\")\ndef read_root(\n    data: PersonalData\n):\n    return {\"Hello\": data.name, \"age\": data.age}\n</code></pre> \u7279\u5b9a\u306e\u6587\u5b57\u5217\u3057\u304b\u8a31\u5bb9\u3057\u306a\u3044\u5834\u5408 <pre><code>class FruitEnum(str, Enum):\n    APPLE = \"Apple\"\n    BANANA = \"Banana\"\n    GRAPE = \"Grape\"\n    ORANGE = \"Orange\"\n\nclass UserData(BaseModel):\n    Fruit: FruitEnum = Field(...\n</code></pre></p> <p>FastAPI \u30af\u30a8\u30ea\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u6587\u5b57\u5217\u306e\u691c\u8a3c</p> <p><code>BaseModel</code>\u306b\u3088\u308a\u4e00\u5c64\u306e\u60c5\u5831\u3092\u4ed8\u4e0e\u3059\u308b <pre><code>from pydantic import BaseModel, Field\n\nclass User(BaseModel):\n    name: str = Field(\n        ..., # \u5fc5\u9808:\"...\" , Optional: \"None\"\n        default=\"Takeshi\",\n        description=\"\u7537\u306e\u5b50\u306e\u540d\u524d\",\n        examples=\"Yuto\"\n    )\n    phone: str = Field(\n        ...,\n        max_length=13, # \u6700\u5927\u6587\u5b57\u5217\u3082\u8a2d\u5b9a\u53ef\u80fd\n        pattern=r\"^\\d{3}-\\d{4}-\\d{4}$\" # \u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\u3082\u53ef\u80fd\n    )\n</code></pre></p> <p>\u4ee5\u4e0b\u306e\u3088\u3046\u306b<code>response_model</code>\u3092\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u3001\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u578b\u3092\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002</p> <pre><code>@app.get(\n    \"/\",\n    response_model=User\n    )\ndef read_root(\n    data: PersonalData\n):\n    return {\"name\": name, \"phone\": phone}\n</code></pre>"},{"location":"python/py-fastapi-01/#db","title":"DB\u8a2d\u5b9a","text":"<p>\u4ee5\u4e0b\u3092\u4f5c\u6210\u3057\u3001main.py\u3067import\u3059\u308c\u3070DB\u64cd\u4f5c\u304c\u3067\u304d\u308b\u3002 database.py <pre><code>from sqlalchemy import create_engine\nfrom sqlalchemy.ext.declarative import declarative_base\nfrom sqlalchemy.orm import sessionmaker\n\nSQLALCHEMY_DATABASE_URL = \"sqlite:///./data.db\"\n# PostgreSQL\u3092\u4f7f\u3046\u5834\u5408\u306f\u4e0b\u3092\u4f7f\u3046\n# SQLALCHEMY_DATABASE_URL = \"postgresql://user:password@postgresserver/db\"\n\nengine = create_engine(\n    SQLALCHEMY_DATABASE_URL, connect_args={\"check_same_thread\": False}\n)\nSessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)\n\nBase = declarative_base()\nBase.metadata.create_all(bind=engine)\n\n# Dependency\ndef get_db():\n    db = SessionLocal()\n    try:\n        yield db\n    finally:\n        db.close()\n</code></pre></p> <p>\u3053\u306e<code>get_db()</code>\u3092main.py\u3067\u547c\u3073\u51fa\u3057\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u53d6\u3063\u305f\u969b\u306b<code>Session</code>\u3092\u4f5c\u6210\u3059\u308b\u3002</p> <pre><code>from fastapi import Depends\nfrom sqlalchemy.orm import Session\nfrom ..models.database import get_db # dir\u69cb\u6210\u6b21\u7b2c\n\n@app.get(\"/\")\ndef read_root(\n    db: Session = Depends(get_db),\n):\n    data = DbClient(db) # \u4f8b) DB\u306b\u63a5\u7d9a\u3057\u3066\u7279\u5b9a\u306e\u5024\u3092\u53d6\u5f97\n    return {\"data\": data}\n</code></pre>"},{"location":"python/py-fastapi-01/#api-router","title":"API Router","text":"<p>\u51e6\u7406\u306e\u7a2e\u985e\u306b\u5fdc\u3058\u3066\u5225\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002 main.py <pre><code>from fastapi import FastAPI\nfrom src.apis import user\n\napp = FastAPI()\n\napp.include_router(user.router, tags=[\"user\"])\n</code></pre></p> <p>src/apis/user.py <pre><code>from fastapi import APIRouter, Header, Depends\n\nrouter = APIRouter()\n\ntop_level = \"user\"\n\n@router.post(\n    f\"/{top_level}/info\",\n    name=\"\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u53d6\u5f97API\",\n    description=\"Header\u306ex_user_id\u3092\u8aad\u307f\u53d6\u3063\u3066\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u8fd4\u3059\",\n)\ndef post_user_info(\n    db: Session = Depends(get_db),\n    # \u30d5\u30ed\u30f3\u30c8\u3067\"headers\"\u306b\u8a2d\u5b9a\u3055\u308c\u305f\u5024\u3092\u53d6\u5f97\u3059\u308b\n    x_user_id: Union[str, None] = Header(None, alias=\"x-key\"),\n):\n    ...\n</code></pre></p>"},{"location":"python/py-fastapi-01/#sql-alchemy","title":"SQL Alchemy","text":""},{"location":"python/py-fastapi-01/#basemodel","title":"BaseModel","text":"<p>src/models/base.py <pre><code>from datetime import datetime\n\nfrom sqlalchemy import Column, DateTime\nfrom sqlalchemy.ext.declarative import declared_attr\n\n\nclass OrgBaseModel(object):\n    @declared_attr\n    def created_at(cls):\n        return Column(DateTime, default=datetime.now, nullable=False)\n\n    @declared_attr\n    def updated_at(cls):\n        return Column(\n            DateTime, default=datetime.now, onupdate=datetime.now, nullable=False\n        )\n</code></pre></p> <p>src/models/t_user.py <pre><code>from sqlalchemy import UUID, Boolean, Column, Integer, String\n\nfrom .base import OrgBaseModel\nfrom .database import Base, engine\n\n\nclass TUser(Base, OrgBaseModel):\n    __tablename__ = \"t_user\"\n\n    id = Column(Integer, primary_key=True, autoincrement=True, nullable=False)\n    name = Column(String, index=True, nullable=False)\n    icon_type = Column(Integer, default=1, nullable=False\n        comment\"0: \u30e6\u30fc\u30b6\u30fc\u30a2\u30a4\u30b3\u30f3, 1: \u30c8\u30c3\u30d7\u30a2\u30a4\u30b3\u30f3\")\n    uuid = Column(UUID, index=True, nullable=False)\n\n# DB\u306b\u63a5\u7d9a\u3057\u3066\u3001\u3053\u306e\u30c6\u30fc\u30d6\u30eb\u304c\u5b58\u5728\u3057\u3066\u3044\u306a\u304b\u3063\u305f\u3089\u30c6\u30fc\u30d6\u30eb\u3092CREATE\u3059\u308b\u51e6\u7406\nBase.metadata.create_all(bind=engine, checkfirst=True)\n</code></pre></p>"},{"location":"python/py-fastapi-01/#crud","title":"CRUD","text":""},{"location":"python/py-fastapi-01/#create","title":"create","text":"<pre><code>from typing import Union\n\nfrom sqlalchemy.ext.asyncio import AsyncSession\n\nfrom ..models.m_item import MItem\n\n\nclass MItemCrud:\n    def insert_m_item(\n        db: AsyncSession,\n        name: str,\n    ) -&gt; Union[MItem, None]:\n        try:\n            item = MItem(\n                name=name,\n            )\n            db.add(item)\n            db.commit()\n            return item\n        except Exception as e:\n            logger.error(e)\n            db.rollback()\n            return None\n</code></pre>"},{"location":"python/py-fastapi-01/#read","title":"read","text":"<pre><code>from typing import Union\n\nfrom sqlalchemy.ext.asyncio import AsyncSession\n\nfrom ..models.m_item import MItem\n\n\nclass MItemCrud:\n    def select_m_item_by_id(\n        db: AsyncSession,\n        index: int,\n    ) -&gt; Union[MItem, None]:\n        try:\n            result = (\n                db.query(MItem)\n                .filter(\n                    MItem.id == index,\n                )\n                .first()\n            )\n            return result\n        except Exception as e:\n            logger.error(e)\n            db.rollback()\n            return None\n</code></pre>"},{"location":"python/py-fastapi-01/#update","title":"update","text":"<pre><code>from typing import Union\nfrom uuid import UUID, uuid4\n\nfrom sqlalchemy.ext.asyncio import AsyncSession\n\nfrom ..models.t_user import TUser\nfrom ..repositories.type import UserBaseInfoType\n\nclass TUserCrud:\n    def update_t_user(\n        db: AsyncSession, data: UserBaseInfoType, user_id: str\n    ) -&gt; Union[TUser, None]:\n        try:\n            user = db.query(TUser).filter(TUser.uuid == UUID(user_id)).first()\n            user.name = data.name\n            db.commit()\n            return user\n        except Exception as e:\n            logger.error(e)\n            db.rollback()\n            return None\n</code></pre>"},{"location":"python/py-fastapi-01/#delete","title":"delete","text":"<pre><code>from typing import Union\nfrom uuid import UUID, uuid4\n\nfrom sqlalchemy.ext.asyncio import AsyncSession\n\nfrom ..models.t_user_material_bag import TUserMaterialBag\n\nclass TUserMaterialBagCrud:\n    def delete_t_user_material_bag(\n        db: AsyncSession,\n        item_id: int,\n        uuid: str,\n    ) -&gt; Union[TUserMaterialBag, None]:\n        try:\n            item = (\n                db.query(TUserMaterialBag).first()\n            )\n            db.delete(item)\n            db.commit()\n            return item\n        except Exception as e:\n            logger.error(e)\n            db.rollback()\n            return None\n</code></pre>"},{"location":"python/py-fastapi-01/#upsert","title":"upsert","text":"<pre><code>from typing import Union\n\nfrom sqlalchemy.ext.asyncio import AsyncSession\n\nfrom ..models.m_item import MItem\n\n\nclass MItemCrud:\n    def updata_m_item(db, data):\n        try:\n            items_to_update_or_create = []\n            for item_data in data:\n                item = db.query(MItem).filter_by(id=item_data[\"id\"]).first()\n                if item:\n                    # \u65e2\u5b58\u306e\u30a2\u30a4\u30c6\u30e0\u3092\u66f4\u65b0\n                    item.name = item_data[\"name\"]\n                else:\n                    # \u65b0\u3057\u3044\u30a2\u30a4\u30c6\u30e0\u3092\u8ffd\u52a0\n                    item = MItem(**item_data)\n                items_to_update_or_create.append(item)\n            db.bulk_save_objects(items_to_update_or_create)\n            db.commit()\n        except Exception as e:\n            logger.error(e)\n            db.rollback()\n            return None\n</code></pre>"},{"location":"python/py-fastapi-01/#mainpy","title":"main.py \u30c6\u30f3\u30d7\u30ec","text":"<pre><code>from fastapi import FastAPI, Request, status\nfrom fastapi.exceptions import RequestValidationError\nfrom fastapi.middleware.cors import CORSMiddleware\nfrom fastapi.responses import JSONResponse\n\nfrom src.apis import act, websocket\nfrom src.common.logger import logger\n\napp = FastAPI()\n\ntarget_host = \"192.168.0.20\"\ntarget_port_front = 3000\ntarget_port_ws = 8000 # WebSocket\u7528\u306e\u30dd\u30fc\u30c8\n\norigins = [\n    f\"http://{target_host}:{target_port_ws}\",\n    f\"http://{target_host}:{target_port_front}\",\n]\n\n# CORS\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306e\u8a2d\u5b9a\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=origins,\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\n@app.exception_handler(RequestValidationError)\nasync def handler(request: Request, exc: RequestValidationError):\n    logger.error(request.headers)\n    logger.error(exc)\n    return JSONResponse(content={}, status_code=status.HTTP_422_UNPROCESSABLE_ENTITY)\n\napp.include_router(act.router, tags=[\"act\"])\napp.include_router(websocket.router, tags=[\"websocket\"])\n</code></pre>"},{"location":"python/py-fastapi-01/#websocket","title":"WebSocket\u7528\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u30c6\u30f3\u30d7\u30ec","text":"<pre><code>import json\n\nfrom fastapi import APIRouter, Depends, WebSocket, WebSocketDisconnect\nfrom sqlalchemy.orm import Session\n\nfrom ..common.response import get_user_id\nfrom ..crud.t_chat_message import TChatMessageCrud\nfrom ..crud.t_user import TUserCrud\nfrom ..models.database import get_db\nfrom ..repositories.type import ChatPostType\n\nrouter = APIRouter()\n\ntop_level = \"ws\"\n\n\n@router.websocket(f\"/{top_level}/chat\")\nasync def websocket_endpoint(\n    websocket: WebSocket,\n    db: Session = Depends(get_db),\n):\n    await websocket.accept()\n    try:\n        while True:\n            # websocket\u304b\u3089post\u3055\u308c\u3066\u304d\u305f\u30c7\u30fc\u30bf\u3092\u30c6\u30ad\u30b9\u30c8\u3067\u53d6\u5f97\n            data_text = await websocket.receive_text()\n            # json\u306b\u5909\u63db\n            data = json.loads(data_text)\n            # DB\u64cd\u4f5c\u306e\u70ba\u578b\u306b\u5f53\u3066\u306f\u3081\u308b\n            user_id = get_user_id(data[\"key\"])\n            chat_data = ChatPostType(\n                message=data[\"message\"],\n                color=int(data[\"color\"]),\n                mention={\n                    \"user_name\": data[\"mention\"][\"user_name\"],\n                    \"open_user_id\": data[\"mention\"][\"open_user_id\"],\n                },\n            )\n\n            # \u767b\u9332\u3057\u3066\u767b\u9332\u3057\u305f\u3082\u306e\u3092\u8fd4\u3059\n            user = TUserCrud.select_t_user_by_uuid(db, user_id)\n            chat = TChatMessageCrud.insert_t_chat_message(db, user_id, chat_data, user)\n            data = {\n                \"user_name\": chat.user_name,\n                \"message\": chat.message,\n                \"open_user_id\": chat.open_user_id,\n                \"created_at\": chat.created_at.strftime(\"%Y-%m-%d %H:%M:%S\"),\n            }\n            await websocket.send_text(\n                json.dumps(\n                    {\n                        \"code\": 200,\n                        \"message\": \"WebSocket\",\n                        \"data\": {\"chats\": data, \"open_id\": user.open_user_id},\n                    }\n                )\n            )\n    except WebSocketDisconnect:\n        print(\"WebSocket connection closed\")\n    except Exception as e:\n        print(f\"Error: {e}\")\n        await websocket.close()\n</code></pre>"},{"location":"python/py-fastapi-01/#user_id","title":"user_id\u6697\u53f7\u5316\u30c6\u30f3\u30d7\u30ec","text":"<p>response.py <pre><code>from fastapi import Header\n\nfrom .code import Code\n\n\ndef get_user_id(x_key: str = Header(None, alias=\"x-key\")):\n    \"\"\"\n    \u30d8\u30c3\u30c0\u30fc\u304b\u3089\u6697\u53f7\u5316\u3055\u308c\u305f\u30e6\u30fc\u30b6\u30fcID\u3092\u53d6\u5f97\u3057\u3001\n    \u5fa9\u53f7\u5316\u3057\u3066\u8fd4\u3059\u3002\n    \u5fa9\u53f7\u3067\u304d\u306a\u304b\u3063\u305f\u3089\u8a8d\u8a3c\u30a8\u30e9\u30fc\u3092\u8fd4\u3059\n    \"\"\"\n    if x_key == \"\" or x_key == None:\n        return \"\"\n    else:\n        try:\n            decrypted_message = Code.decrypt_message(x_key)\n            return decrypted_message\n        except:\n            return \"\"\n</code></pre></p> <p>\u30d1\u30b9\u30ef\u30fc\u30c9\u30d9\u30fc\u30b9\u6697\u53f7\u5316 code.py <pre><code>import base64\n\nfrom cryptography.fernet import Fernet\nfrom cryptography.hazmat.backends import default_backend\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC\nfrom fastapi import HTTPException\n\nfrom .const import CODE_PASSPHRASE\n\n\nclass Code:\n    # \u6697\u53f7\u5316\u95a2\u6570\n    def encrypt_message(message: str) -&gt; bytes:\n        key = Code.generate_key_from_passphrase(CODE_PASSPHRASE)\n        fernet = Fernet(key)\n        return str(fernet.encrypt(message.encode()))[2:-1]\n\n    # \u5fa9\u53f7\u5316\u95a2\u6570\n    def decrypt_message(encrypted_message: bytes) -&gt; str:\n        try:\n            key = Code.generate_key_from_passphrase(CODE_PASSPHRASE)\n            fernet = Fernet(key)\n            return fernet.decrypt(encrypted_message.encode(\"utf-8\")).decode(\"utf-8\")\n        except Exception as e:\n            raise HTTPException(\n                status_code=400, detail=\"Invalid encryption or corrupted data\"\n            )\n\n    # \u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\u304b\u3089\u30ad\u30fc\u3092\u751f\u6210\u3059\u308b\u95a2\u6570\n    def generate_key_from_passphrase(passphrase: str) -&gt; bytes:\n        passphrase = passphrase.encode()  # \u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\u3092bytes\u578b\u306b\u5909\u63db\n        salt = (\n            b\"salt_\"  # \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5411\u4e0a\u306e\u305f\u3081\u306e\u30bd\u30eb\u30c8\uff08\u5b9f\u969b\u306b\u306f\u30e9\u30f3\u30c0\u30e0\u306a\u5024\u3092\u4f7f\u3046\u3079\u304d\uff09\n        )\n        kdf = PBKDF2HMAC(\n            algorithm=hashes.SHA256(),\n            length=32,\n            salt=salt,\n            iterations=390000,\n            backend=default_backend(),\n        )\n        key = base64.urlsafe_b64encode(kdf.derive(passphrase))  # \u5b89\u5168\u306a\u9375\u3092\u751f\u6210\n        return key\n</code></pre></p>"},{"location":"python/py-mkdocs-01/","title":"MkDocks","text":""},{"location":"python/py-pathlib-01/","title":"Pathlib","text":""},{"location":"python/py-pytest-01/","title":"Pytest","text":""},{"location":"python/py-subpro-01/","title":"subprocess","text":""},{"location":"stablediffusion/sd-first-01/","title":"Stable Diffusion","text":""},{"location":"stablediffusion/sd-prompt-01/","title":"\u30d7\u30ed\u30f3\u30d7\u30c8","text":""}]}